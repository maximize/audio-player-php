(()=>{"use strict";class e extends HTMLElement{constructor(){super();const e=document.querySelector('template[id="audio"]');if(!e)throw new Error("[AudioPlayer] O template do áudio não foi encontrado");this.innerHTML=e.innerHTML}connectedCallback(){(e=>{if(!e)throw new Error("[AudioPlayer] Não foi possível criar a elementRoot");const t=e.querySelector(".audio__title"),a=e.querySelector(".audio__description"),s=e.querySelector(".audio__folder span"),n=e.querySelector(".audio"),o=e.querySelector(".audio__play"),i=e.querySelector(".audio__slider"),r=e.querySelector(".volume"),l=e.querySelector(".volume__slider"),d=e.querySelector(".volume__button"),u=e.querySelector("audio"),c=e.querySelector(".time__duration"),m=e.querySelector(".time__current");if([t,a,s,n,o,i,l,d,u,c,m].some((e=>!e)))throw new Error("[AudioPlayer] Não foi possível montar o player");let p="play",v=0;const _=e.getAttribute("data-title")||"";u.src=e.getAttribute("data-src")||"";const y=e.getAttribute("data-description")||"";a.textContent=y;const g=document.createElement("span");g.textContent=_,t.append(g),(new Image).src="/assets/img/audio-pause.svg";const f=()=>{i.value=Math.floor(u.currentTime).toString();const e=parseFloat(i.value),t=parseFloat(i.max);m.textContent=h(e),n.style.setProperty("--seek-before-width",e/t*100+"%"),v=requestAnimationFrame(f)},S=e=>{const t=parseFloat(e.value),a=parseFloat(e.value);e===i?n.style.setProperty("--seek-before-width",t/a*100+"%"):n.style.setProperty("--volume-before-width",t/a*100+"%")},h=e=>{const t=Math.floor(e/60),a=Math.floor(e%60);return`${t}:${a<10?`0${a}`:`${a}`}`},w=()=>{c.textContent=h(u.duration)},A=()=>{i.max=Math.floor(u.duration).toString()},b=()=>{const e=Math.floor(u.buffered.end(u.buffered.length-1)),t=parseFloat(i.max);n.style.setProperty("--buffered-width",e/t*100+"%")};u.readyState>0?(w(),A(),b()):u.addEventListener("loadedmetadata",(()=>{w(),A(),b()})),o.addEventListener("click",(()=>{"play"===p?(u.play(),requestAnimationFrame(f),p="pause",o.classList.add("audio__play--stopped")):(u.pause(),cancelAnimationFrame(v),p="play",o.classList.remove("audio__play--stopped"))})),u.addEventListener("progress",b),i.addEventListener("input",(()=>{const e=parseFloat(i.value);S(i),m.textContent=h(e),u.paused||cancelAnimationFrame(v)})),i.addEventListener("change",(()=>{u.currentTime=parseFloat(i.value),u.paused||requestAnimationFrame(f)})),l.addEventListener("input",(()=>{const e=parseFloat(l.value);S(l),u.volume=e/100})),d.addEventListener("click",(()=>{null==r||r.classList.toggle("volume--show")}));let k=0;e.addEventListener("mouseleave",(()=>{k=window.setTimeout((()=>{null==r||r.classList.remove("volume--show")}),500)})),e.addEventListener("mouseenter",(()=>{clearTimeout(k)})),window.addEventListener("click",(t=>{(null==e?void 0:e.contains(t.target))||null==r||r.classList.remove("volume--show")})),"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:_,artist:(null==s?void 0:s.textContent)||"",artwork:[{src:"/assets/img/folder.jpg",sizes:"96x96",type:"image/jpg"},{src:"/assets/img/folder.jpg",sizes:"128x128",type:"image/jpg"},{src:"/assets/img/folder.jpg",sizes:"192x192",type:"image/jpg"},{src:"/assets/img/folder.jpg",sizes:"256x256",type:"image/jpg"},{src:"/assets/img/folder.jpg",sizes:"384x384",type:"image/jpg"},{src:"/assets/img/folder.jpg",sizes:"512x512",type:"image/jpg"}]}),navigator.mediaSession.setActionHandler("play",(()=>{"play"===p?(u.play(),requestAnimationFrame(f),p="pause"):(u.pause(),cancelAnimationFrame(v),p="play")})),navigator.mediaSession.setActionHandler("pause",(()=>{"play"===p?(u.play(),requestAnimationFrame(f),p="pause"):(u.pause(),cancelAnimationFrame(v),p="play")})),navigator.mediaSession.setActionHandler("seekbackward",(e=>{u.currentTime=u.currentTime-(e.seekOffset||10)})),navigator.mediaSession.setActionHandler("seekforward",(e=>{u.currentTime=u.currentTime+(e.seekOffset||10)})),navigator.mediaSession.setActionHandler("seekto",(e=>{e.seekTime&&(e.fastSeek&&"fastSeek"in u?u.fastSeek(e.seekTime):u.currentTime=e.seekTime)})),navigator.mediaSession.setActionHandler("stop",(()=>{u.currentTime=0,i.value="0",n.style.setProperty("--seek-before-width","0%"),m.textContent="0:00","pause"===p&&(cancelAnimationFrame(v),p="play")})))})(this)}}!function(){const e=document.querySelector(".audio__folder > span"),t=document.createElement("template");t.id="audio",t.innerHTML=`\n        <div class="audio">\n            <audio src="" preload="metadata"></audio>\n            <h1 class="audio__title"></h1>\n            <div class="audio__folder">\n                <span>${(null==e?void 0:e.textContent)||""}</span>\n            </div>\n            <div class="audio__controls">\n                <button class="audio__button audio__play">\n                    <span>Play/Stop</span>\n                </button>\n                <div class="audio__time time">\n                    <span class="time__current">0:00</span>\n                    <span>/</span>\n                    <span class="time__duration">0:00</span>\n                </div>\n                <div class="audio__timeline">\n                    <input type="range" class="audio__slider slider" max="100" value="0">\n                </div>\n                <div class="audio__volume volume">\n                    <div class="audio__timeline">\n                        <input type="range" class="volume__slider audio__slider" max="100" value="100">                    \n                    </div>\n                    <button class="audio__button volume__button">\n                        <span>Volume</span>\n                    </button>\n                </div>\n            </div>\n            <span class="audio__description"></span>\n        </div>\n    `,document.body.appendChild(t)}(),customElements.define("audio-player",e)})();